# 智能清扫系统算法选择功能使用指南

## 🎯 功能概述

我们已成功将路径规划算法选择功能集成到智能清扫系统的启动脚本中。现在您可以通过终端交互式地选择和配置不同的路径规划算法。

## 🚀 使用方法

### 1. 启动智能清扫系统
```bash
cd /home/getting/Sweeping-Robot
./start_intelligent_cleaning.sh smart
```

### 2. 交互式配置流程

启动脚本会依次提示您进行以下配置：

#### 步骤1: 选择地图
```
请输入地图名称 [hospital_0.1]: 
```
- 直接按回车使用默认地图 `hospital_0.1`
- 或输入其他可用的地图名称

#### 步骤2: 选择路径规划算法
```
=== 路径规划算法选择 ===
1) A*算法 (astar) - 基于启发式搜索，路径质量优秀
2) 神经网络算法 (neural) - 快速响应，计算复杂度低

请选择路径规划算法 [1-2]: 
```

#### 步骤3: 配置算法参数

**选择A*算法时：**
```
=== 算法参数配置 ===
A*算法参数:
- 启发式权重 (heuristic_weight): 1.0
- 覆盖策略 (coverage_strategy): nearest
- 最大迭代次数 (max_iterations): 10000

是否使用自定义参数? [y/N]: 
```

如果选择自定义参数，会进一步提示：
- **启发式权重**: 影响路径搜索的方向性 (推荐范围: 0.5-2.0)
- **覆盖策略**:
  - `nearest`: 优先访问最近的未覆盖点
  - `farthest`: 优先访问最远的未覆盖点  
  - `spiral`: 螺旋式覆盖策略
- **最大迭代次数**: 防止算法无限循环

**选择神经网络算法时：**
```
神经网络算法参数:
- 网络参数 (c_0): 50.0
- 最大迭代次数 (max_iterations): 9000

是否使用自定义参数? [y/N]: 
```

#### 步骤4: 确认启动
系统会显示完整配置信息：
```
启动配置:
- 地图: hospital_0.1
- 路径规划算法: A*算法 (astar)
- A*参数: weight=1.2, strategy=nearest, max_iter=10000
- 覆盖率监控: 启用
- CSV数据记录: 启用 (每30秒)
- 自动重启: 启用 (2分钟停滞阈值)
- 最大重启次数: 500次

确认启动? [Y/n]: 
```

## 🔧 技术实现细节

### 1. 配置文件动态生成
- 系统会根据您的选择动态生成临时配置文件
- 原始配置文件会自动备份 (带时间戳)
- 临时配置应用到 `path_planning_params.yaml`

### 2. 参数实时设置
- 系统启动后会通过ROS服务设置算法参数
- 支持运行时动态切换算法
- 自动验证参数设置是否成功

### 3. 集成功能
- **覆盖率监控**: 实时追踪清扫覆盖率
- **CSV数据记录**: 每30秒保存性能数据
- **自动重启**: 检测到停滞时自动重启
- **智能管理**: 完整的系统生命周期管理

## 📊 算法对比

| 特性 | A*算法 | 神经网络算法 |
|------|--------|--------------|
| **路径质量** | 优秀 | 良好 |
| **计算速度** | 中等 | 快速 |
| **内存使用** | 中等 | 低 |
| **覆盖率** | 高 | 中等 |
| **适用场景** | 精确覆盖 | 实时响应 |
| **参数调节** | 灵活 | 简单 |

## 🎮 使用示例

### 示例1: 使用A*算法进行精确清扫
```bash
./start_intelligent_cleaning.sh smart

# 按提示操作:
# 地图: hospital_0.1 (默认)
# 算法: 1 (A*算法)
# 自定义参数: y
# 启发式权重: 1.2
# 覆盖策略: 1 (nearest)
# 最大迭代: 15000
# 确认启动: Y
```

### 示例2: 使用神经网络算法进行快速清扫
```bash
./start_intelligent_cleaning.sh smart

# 按提示操作:
# 地图: hospital_0.1 (默认)
# 算法: 2 (神经网络)
# 自定义参数: n (使用默认)
# 确认启动: Y
```

## 🔍 监控和调试

### 1. 查看系统状态
```bash
./start_intelligent_cleaning.sh status
```

### 2. 查看实时日志
```bash
tail -f nohup.out
```

### 3. 动态切换算法 (运行时)
```bash
# 切换到A*算法
rosservice call /path_planning/set_algorithm "algorithm_type: 'astar'"

# 切换到神经网络算法
rosservice call /path_planning/set_algorithm "algorithm_type: 'neural'"

# 调整参数
rosservice call /path_planning/set_parameter "param_name: 'heuristic_weight' param_value: 1.5"
```

## 📁 相关文件

- **启动脚本**: `start_intelligent_cleaning.sh`
- **配置文件**: `src/auto_nav/config/path_planning_params.yaml`
- **备份目录**: `src/auto_nav/config/` (自动生成带时间戳的备份)
- **临时文件**: `/home/getting/tmp/` (自动清理)

## 🎉 功能优势

1. **用户友好**: 交互式界面，无需手动编辑配置文件
2. **安全可靠**: 自动备份原始配置，支持快速恢复
3. **实时调整**: 支持运行时切换算法和参数
4. **完整集成**: 与现有监控、重启、数据记录功能无缝整合
5. **灵活扩展**: 易于添加新的算法类型和参数

现在您可以根据不同的清扫需求，灵活选择最适合的路径规划算法，并实时调整参数以获得最佳的清扫效果！
